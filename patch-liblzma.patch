diff --git a/ports/liblzma/patch-liblzma.patch b/ports/liblzma/patch-liblzma.patch
new file mode 100644
index 000000000..474ce2c09
--- /dev/null
+++ b/ports/liblzma/patch-liblzma.patch
@@ -0,0 +1,13 @@
+diff --git a/CMakeLists.txt b/CMakeLists.txt
+index 63c8f3d..9d662be 100644
+--- a/CMakeLists.txt
++++ b/CMakeLists.txt
+@@ -394,7 +394,7 @@ if(BUILD_SHARED_LIBS)
+     set_target_properties(liblzma PROPERTIES C_VISIBILITY_PRESET hidden)
+     target_compile_definitions(liblzma PRIVATE HAVE_VISIBILITY=1)
+ else()
+-    target_compile_definitions(liblzma PRIVATE HAVE_VISIBILITY=0)
++    target_compile_definitions(liblzma PRIVATE HAVE_VISIBILITY=1)
+ endif()
+ 
+ if(WIN32)
diff --git a/ports/liblzma/portfile.cmake b/ports/liblzma/portfile.cmake
index 052281e3f..7149694a9 100644
--- a/ports/liblzma/portfile.cmake
+++ b/ports/liblzma/portfile.cmake
@@ -10,6 +10,7 @@ vcpkg_from_github(
         win_output_name.patch # Fix output name on Windows. Autotool build does not generate lib prefixed libraries on windows. 
         add_support_ios.patch # add install bundle info for support ios 
         build-tools.patch
+        patch-liblzma.patch
 )
 
 vcpkg_check_features(OUT_FEATURE_OPTIONS FEATURE_OPTIONS
